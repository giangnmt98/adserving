# Environment Configuration Template for Async Processing System
# Copy this file to .env and update the values according to your environment

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis server connection settings
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=DsteamIC2025

# Redis connection pool settings
REDIS_SOCKET_TIMEOUT=30
REDIS_SOCKET_CONNECT_TIMEOUT=30
REDIS_MAX_CONNECTIONS=50
REDIS_RETRY_ON_TIMEOUT=true
REDIS_HEALTH_CHECK_INTERVAL=30

# =============================================================================
# POSTGRESQL DATABASE CONFIGURATION
# =============================================================================

# Database server connection settings
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=adserving
DATABASE_USER=admin
DATABASE_PASSWORD=admin

# Database connection pool settings
DATABASE_MIN_CONNECTIONS=5
DATABASE_MAX_CONNECTIONS=20
DATABASE_COMMAND_TIMEOUT=60

# TimescaleDB settings (optional)
DATABASE_ENABLE_TIMESCALEDB=false
DATABASE_TIMESCALEDB_RETENTION_DAYS=30

# =============================================================================
# ASYNC PROCESSING SYSTEM CONFIGURATION
# =============================================================================

# Enable/disable async processing
ASYNC_PROCESSING_ENABLED=true

# Worker configuration
ASYNC_PROCESSING_NUM_WORKERS=4
CONSUMER_BATCH_SIZE=10
CONSUMER_BLOCK_TIME_MS=1000
CONSUMER_MAX_RETRIES=3
CONSUMER_RETRY_DELAY=5
CONSUMER_TIMEOUT=300

# Stream configuration
ASYNC_PROCESSING_MAX_STREAM_LENGTH=100000
ASYNC_PROCESSING_STREAM_TRIM_INTERVAL=3600

# Monitoring configuration
ASYNC_PROCESSING_MONITORING_ENABLED=true
ASYNC_PROCESSING_MONITORING_INTERVAL=60
ASYNC_PROCESSING_HEALTH_CHECK_INTERVAL=30
ASYNC_PROCESSING_HEALTH_CHECK_TIMEOUT=10

# Retry and error handling
ASYNC_PROCESSING_MAX_RETRY_ATTEMPTS=3
ASYNC_PROCESSING_RETRY_BACKOFF_SECONDS=5
ASYNC_PROCESSING_DEAD_LETTER_QUEUE_ENABLED=true

# =============================================================================
# RAY CONFIGURATION
# =============================================================================

# Ray cluster settings
RAY_ADDRESS=auto
RAY_NAMESPACE=adserving
RAY_RUNTIME_ENV_WORKING_DIR=
RAY_LOG_TO_DRIVER=true

# Ray resource settings
RAY_NUM_CPUS=
RAY_NUM_GPUS=0
RAY_MEMORY=
RAY_OBJECT_STORE_MEMORY=

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Logging levels
LOG_LEVEL=INFO
ASYNC_PROCESSING_LOG_LEVEL=INFO
DATABASE_LOG_LEVEL=WARNING
REDIS_LOG_LEVEL=WARNING

# Log file settings
LOG_DIR=logs
LOG_MAX_FILE_SIZE=209715200
LOG_BACKUP_COUNT=10
LOG_ENABLE_CONSOLE=true
LOG_ENABLE_STRUCTURED=true

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Memory settings
ASYNC_PROCESSING_MEMORY_LIMIT_MB=1024
ASYNC_PROCESSING_GC_INTERVAL=60

# Batch processing settings
ASYNC_PROCESSING_ENABLE_BATCHING=true
ASYNC_PROCESSING_BATCH_TIMEOUT_MS=100

# Connection settings
ASYNC_PROCESSING_CONNECTION_TIMEOUT=30
ASYNC_PROCESSING_SOCKET_KEEPALIVE=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# API security
ASYNC_PROCESSING_ENABLE_AUTH=false
ASYNC_PROCESSING_API_KEY=
ASYNC_PROCESSING_ALLOWED_IPS=

# SSL/TLS settings
REDIS_SSL_ENABLED=false
REDIS_SSL_CERT_PATH=
REDIS_SSL_KEY_PATH=
REDIS_SSL_CA_CERT_PATH=

DATABASE_SSL_ENABLED=false
DATABASE_SSL_CERT_PATH=
DATABASE_SSL_KEY_PATH=
DATABASE_SSL_CA_CERT_PATH=

# =============================================================================
# DEVELOPMENT/TESTING CONFIGURATION
# =============================================================================

# Development mode
DEVELOPMENT_MODE=false
DEBUG_ENABLED=false

# Testing settings
TEST_DATABASE_NAME=adserving_test
TEST_REDIS_DB=1
TEST_ASYNC_PROCESSING_ENABLED=true
TEST_NUM_WORKERS=2

# Mock settings for testing
USE_MOCK_REDIS=false
USE_MOCK_DATABASE=false
USE_MOCK_RAY=false

# =============================================================================
# MONITORING AND METRICS
# =============================================================================

# Prometheus metrics
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090
PROMETHEUS_METRICS_PATH=/metrics

# Health check endpoints
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PORT=8080
HEALTH_CHECK_PATH=/health

# Alerting
ALERTING_ENABLED=false
ALERTING_WEBHOOK_URL=
ALERTING_SLACK_CHANNEL=
ALERTING_EMAIL_RECIPIENTS=

# =============================================================================
# STREAM NAMES CONFIGURATION
# =============================================================================

# Redis stream names (customize if needed)
STREAM_TRAINING_DATA=training_data_stream
STREAM_INFERENCE_RESULTS=inference_results_stream
STREAM_BATCH_PROCESSING=batch_processing_stream

# Consumer group names
CONSUMER_GROUP_TRAINING=training_workers
CONSUMER_GROUP_INFERENCE=inference_workers
CONSUMER_GROUP_BATCH=batch_workers

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================

# Database backup settings
DATABASE_BACKUP_ENABLED=false
DATABASE_BACKUP_SCHEDULE=0 2 * * *
DATABASE_BACKUP_RETENTION_DAYS=7
DATABASE_BACKUP_PATH=/backups/database

# Redis backup settings
REDIS_BACKUP_ENABLED=false
REDIS_BACKUP_SCHEDULE=0 3 * * *
REDIS_BACKUP_RETENTION_DAYS=3
REDIS_BACKUP_PATH=/backups/redis
